# Question 4a
day_counts <- table(data$Invoice_Day_Week)
day_df <- as.data.frame(day_counts)
colnames(day_df) <- c("Day", "TransactionCount")
total_transactions <- sum(day_df$TransactionCount)
day_df$Percentage <- (day_df$TransactionCount / total_transactions) * 100
# print(day_df)
# Question 4b
day_value_df <- aggregate(TransactionValue ~ Invoice_Day_Week, data = data, sum)
total_volume <- sum(day_value_df$TransactionValue)
day_value_df$Percentage <- (day_value_df$TransactionValue / total_volume) * 100
# print(day_value_df)
# Question 4c
month_value_df <- aggregate(TransactionValue ~ New_Invoice_Month, data = data, sum)
total_volume <- sum(month_value_df$TransactionValue)
month_value_df$Percentage <- (month_value_df$TransactionValue / total_volume) * 100
# print(month_value_df)
# Question 4d
au_data <- subset(data, Country == "Australia")
date_counts <- table(au_data$New_Invoice_Date)
max_date <- names(date_counts[which.max(date_counts)])
max_count <- max(date_counts)
#cat("Highest AU date:", max_date, "\nTransactions:", max_count, "\n")
#Question 4e
# Step 3: Filter only hours between 7 and 20 (IT working hours)
work_hrs <- subset(data, New_Invoice_Hour >= 7 & New_Invoice_Hour <= 20)
hr_cnts <- table(work_hrs$New_Invoice_Hour)
min_transactions <- Inf
best_start <- NA
for (i in 7:19) {
count1 <- hr_cnts[as.character(i)]
count2 <- hr_cnts[as.character(i + 1)]
total <- sum(count1, count2, na.rm = TRUE)
if (total < min_transactions) {
min_transactions <- total
best_start <- i
}
}
#cat("Start:", best_start, ":00 to", best_start + 2, ":00\n")
#cat("Transactions:", min_transactions, "\n")
# Question 5
germany_data <- subset(data, Country == "Germany")
hist(
germany_data$TransactionValue,
main = "Transaction Histogram - Germany",
xlab = "Transaction Value",
col = "red"
)
# Question 6
transaction_counts <- table(data$CustomerID)
max_count_id <- names(which.max(transaction_counts))
max_count <- max(transaction_counts)
#cat("CustomerID:", max_count_id, "\n")
#cat("Transactions:", max_count, "\n\n")
cust_val <- aggregate(TransactionValue ~ CustomerID, data = data, sum)
best_cust <- cust_val[which.max(cust_val$TransactionValue), ]
#cat("Frequent Customer:", max_count_id, "\n", "Transactions:", max_count, "\n", "Best Customer:", best_cust$CustomerID, "\n", "Value:", round(best_cust$TransactionValue, 2), "\n")
# Question 7
missing_percent <- colMeans(is.na(data)) * 100
#print(round(missing_percent, 2))
# Question 8
missing_id <- subset(data, is.na(CustomerID))
missing_by_country <- table(missing_id$Country)
missing_by_country_df <- as.data.frame(missing_by_country)
colnames(missing_by_country_df) <- c("Country", "MissingID_Count")
#print(missing_by_country_df[order(-missing_by_country_df$MissingID_Count), ])
# Question 9
data_filter <- subset(data, !is.na(CustomerID))
customer_dates <- data_filter %>%
distinct(CustomerID, New_Invoice_Date) %>%
arrange(CustomerID, New_Invoice_Date)
customer_diffs <- customer_dates %>%
group_by(CustomerID) %>%
mutate(DaysBetween = as.numeric(New_Invoice_Date - lag(New_Invoice_Date))) %>%
ungroup()
avg_days <- mean(customer_diffs$DaysBetween, na.rm = TRUE)
#cat("Avg num days:", round(avg_days, 2))
#Question 10
france_data <- subset(data, Country == "France")
total_rows <- nrow(france_data)
negative_rows <- sum(france_data$Quantity < 0, na.rm = TRUE)
neg_ratio <- negative_rows / total_rows
#cat("Ratio:", round(neg_ratio, 4), "\n")
# Question 11
stockcode_tot <- aggregate(TransactionValue ~ StockCode, data = data, sum)
top_stock <- stockcode_tot[which.max(stockcode_tot$TransactionValue), ]
cat("StockCode:", top_stock$StockCode, "\nTransactionValue:", round(top_stock$TransactionValue, 2), "\n")
library(dplyr)
data <- read.csv("Online_Retail.csv")
# Question 1
country_counts <- table(data$Country)
country_df <- as.data.frame(country_counts)
# print(country_df)
colnames(country_df) <- c("Country", "TransactionCount")
total_transactions <- sum(country_df$TransactionCount)
# print(total_transactions)
country_df$Percentage <- (country_df$TransactionCount / total_transactions) * 100
country_df_filtered <- subset(country_df, Percentage > 1)
country_df_filtered <- country_df_filtered[order(-country_df_filtered$TransactionCount), ]
# print(country_df_filtered)
# Question 2
data$TransactionValue <- data$Quantity * data$UnitPrice
# print(data$TransactionValue)
# Question 3
country_transaction_values <- aggregate(TransactionValue ~ Country, data = data, sum)
target_countries <- subset(country_transaction_values, TransactionValue > 130000)
target_countries <- target_countries[order(-target_countries$TransactionValue), ]
# print(target_countries)
# Question 4
Temp=strptime(data$InvoiceDate,format='%m/%d/%Y %H:%M',tz='GMT')
# head(Temp)
data$New_Invoice_Date <- as.Date(Temp)
data$New_Invoice_Date[20000]- data$New_Invoice_Date[10]
data$Invoice_Day_Week= weekdays(data$New_Invoice_Date)
data$New_Invoice_Hour = as.numeric(format(Temp, "%H"))
data$New_Invoice_Month = as.numeric(format(Temp, "%m"))
# Question 4a
day_counts <- table(data$Invoice_Day_Week)
day_df <- as.data.frame(day_counts)
colnames(day_df) <- c("Day", "TransactionCount")
total_transactions <- sum(day_df$TransactionCount)
day_df$Percentage <- (day_df$TransactionCount / total_transactions) * 100
# print(day_df)
# Question 4b
day_value_df <- aggregate(TransactionValue ~ Invoice_Day_Week, data = data, sum)
total_volume <- sum(day_value_df$TransactionValue)
day_value_df$Percentage <- (day_value_df$TransactionValue / total_volume) * 100
# print(day_value_df)
# Question 4c
month_value_df <- aggregate(TransactionValue ~ New_Invoice_Month, data = data, sum)
total_volume <- sum(month_value_df$TransactionValue)
month_value_df$Percentage <- (month_value_df$TransactionValue / total_volume) * 100
# print(month_value_df)
# Question 4d
au_data <- subset(data, Country == "Australia")
date_counts <- table(au_data$New_Invoice_Date)
max_date <- names(date_counts[which.max(date_counts)])
max_count <- max(date_counts)
#cat("Highest AU date:", max_date, "\nTransactions:", max_count, "\n")
#Question 4e
# Step 3: Filter only hours between 7 and 20 (IT working hours)
work_hrs <- subset(data, New_Invoice_Hour >= 7 & New_Invoice_Hour <= 20)
hr_cnts <- table(work_hrs$New_Invoice_Hour)
min_transactions <- Inf
best_start <- NA
for (i in 7:19) {
count1 <- hr_cnts[as.character(i)]
count2 <- hr_cnts[as.character(i + 1)]
total <- sum(count1, count2, na.rm = TRUE)
if (total < min_transactions) {
min_transactions <- total
best_start <- i
}
}
#cat("Start:", best_start, ":00 to", best_start + 2, ":00\n")
#cat("Transactions:", min_transactions, "\n")
# Question 5
germany_data <- subset(data, Country == "Germany")
hist(
germany_data$TransactionValue,
main = "Transaction Histogram - Germany",
xlab = "Transaction Value",
col = "red"
)
# Question 6
transaction_counts <- table(data$CustomerID)
max_count_id <- names(which.max(transaction_counts))
max_count <- max(transaction_counts)
#cat("CustomerID:", max_count_id, "\n")
#cat("Transactions:", max_count, "\n\n")
cust_val <- aggregate(TransactionValue ~ CustomerID, data = data, sum)
best_cust <- cust_val[which.max(cust_val$TransactionValue), ]
#cat("Frequent Customer:", max_count_id, "\n", "Transactions:", max_count, "\n", "Best Customer:", best_cust$CustomerID, "\n", "Value:", round(best_cust$TransactionValue, 2), "\n")
# Question 7
missing_percent <- colMeans(is.na(data)) * 100
#print(round(missing_percent, 2))
# Question 8
missing_id <- subset(data, is.na(CustomerID))
missing_by_country <- table(missing_id$Country)
missing_by_country_df <- as.data.frame(missing_by_country)
colnames(missing_by_country_df) <- c("Country", "MissingID_Count")
#print(missing_by_country_df[order(-missing_by_country_df$MissingID_Count), ])
# Question 9
data_filter <- subset(data, !is.na(CustomerID))
customer_dates <- data_filter %>%
distinct(CustomerID, New_Invoice_Date) %>%
arrange(CustomerID, New_Invoice_Date)
customer_diffs <- customer_dates %>%
group_by(CustomerID) %>%
mutate(DaysBetween = as.numeric(New_Invoice_Date - lag(New_Invoice_Date))) %>%
ungroup()
avg_days <- mean(customer_diffs$DaysBetween, na.rm = TRUE)
#cat("Avg num days:", round(avg_days, 2))
#Question 10
france_data <- subset(data, Country == "France")
total_rows <- nrow(france_data)
negative_rows <- sum(france_data$Quantity < 0, na.rm = TRUE)
neg_ratio <- negative_rows / total_rows
#cat("Ratio:", round(neg_ratio, 4), "\n")
# Question 11
stockcode_tot <- aggregate(TransactionValue ~ StockCode, data = data, sum)
top_stock <- stockcode_tot[which.max(stockcode_tot$TransactionValue), ]
#cat("StockCode:", top_stock$StockCode, "\nTransactionValue:", round(top_stock$TransactionValue, 2), "\n")
# Question 12
unique_customers <- length(unique(data$CustomerID[!is.na(data$CustomerID)]))
cat("Number of unique CustomerIDs:", unique_customers, "\n")
library(dplyr)
data <- read.csv("Online_Retail.csv")
# Question 1
country_counts <- table(data$Country)
country_df <- as.data.frame(country_counts)
# print(country_df)
colnames(country_df) <- c("Country", "TransactionCount")
total_transactions <- sum(country_df$TransactionCount)
# print(total_transactions)
country_df$Percentage <- (country_df$TransactionCount / total_transactions) * 100
country_df_filtered <- subset(country_df, Percentage > 1)
country_df_filtered <- country_df_filtered[order(-country_df_filtered$TransactionCount), ]
print(country_df_filtered)
# Question 2
data$TransactionValue <- data$Quantity * data$UnitPrice
print(data$TransactionValue)
# Question 3
country_transaction_values <- aggregate(TransactionValue ~ Country, data = data, sum)
target_countries <- subset(country_transaction_values, TransactionValue > 130000)
target_countries <- target_countries[order(-target_countries$TransactionValue), ]
print(target_countries)
# Question 4
Temp=strptime(data$InvoiceDate,format='%m/%d/%Y %H:%M',tz='GMT')
# head(Temp)
data$New_Invoice_Date <- as.Date(Temp)
data$New_Invoice_Date[20000]- data$New_Invoice_Date[10]
data$Invoice_Day_Week= weekdays(data$New_Invoice_Date)
data$New_Invoice_Hour = as.numeric(format(Temp, "%H"))
data$New_Invoice_Month = as.numeric(format(Temp, "%m"))
# Question 4a
day_counts <- table(data$Invoice_Day_Week)
day_df <- as.data.frame(day_counts)
colnames(day_df) <- c("Day", "TransactionCount")
total_transactions <- sum(day_df$TransactionCount)
day_df$Percentage <- (day_df$TransactionCount / total_transactions) * 100
print(day_df)
# Question 4b
day_value_df <- aggregate(TransactionValue ~ Invoice_Day_Week, data = data, sum)
total_volume <- sum(day_value_df$TransactionValue)
day_value_df$Percentage <- (day_value_df$TransactionValue / total_volume) * 100
print(day_value_df)
# Question 4c
month_value_df <- aggregate(TransactionValue ~ New_Invoice_Month, data = data, sum)
total_volume <- sum(month_value_df$TransactionValue)
month_value_df$Percentage <- (month_value_df$TransactionValue / total_volume) * 100
print(month_value_df)
# Question 4d
au_data <- subset(data, Country == "Australia")
date_counts <- table(au_data$New_Invoice_Date)
max_date <- names(date_counts[which.max(date_counts)])
max_count <- max(date_counts)
cat("Highest AU date:", max_date, "\nTransactions:", max_count, "\n")
#Question 4e
work_hrs <- subset(data, New_Invoice_Hour >= 7 & New_Invoice_Hour <= 20)
hr_cnts <- table(work_hrs$New_Invoice_Hour)
min_transactions <- Inf
best_start <- NA
for (i in 7:19) {
count1 <- hr_cnts[as.character(i)]
count2 <- hr_cnts[as.character(i + 1)]
total <- sum(count1, count2, na.rm = TRUE)
if (total < min_transactions) {
min_transactions <- total
best_start <- i
}
}
cat("Start:", best_start, ":00 to", best_start + 2, ":00\nTransactions:", min_transactions, "\n")
# Question 5
germany_data <- subset(data, Country == "Germany")
hist(
germany_data$TransactionValue,
main = "Transaction Histogram - Germany",
xlab = "Transaction Value",
col = "red"
)
# Question 6
transaction_counts <- table(data$CustomerID)
max_count_id <- names(which.max(transaction_counts))
max_count <- max(transaction_counts)
#cat("CustomerID:", max_count_id, "\n")
#cat("Transactions:", max_count, "\n\n")
cust_val <- aggregate(TransactionValue ~ CustomerID, data = data, sum)
best_cust <- cust_val[which.max(cust_val$TransactionValue), ]
cat("Frequent Customer:", max_count_id, "\n", "Transactions:", max_count, "\n", "Best Customer:", best_cust$CustomerID, "\n", "Value:", round(best_cust$TransactionValue, 2), "\n")
# Question 7
missing_percent <- colMeans(is.na(data)) * 100
print(round(missing_percent, 2))
# Question 8
missing_id <- subset(data, is.na(CustomerID))
missing_by_country <- table(missing_id$Country)
missing_by_country_df <- as.data.frame(missing_by_country)
colnames(missing_by_country_df) <- c("Country", "MissingID_Count")
print(missing_by_country_df[order(-missing_by_country_df$MissingID_Count), ])
# Question 9
data_filter <- subset(data, !is.na(CustomerID))
customer_dates <- data_filter %>%
distinct(CustomerID, New_Invoice_Date) %>%
arrange(CustomerID, New_Invoice_Date)
customer_diffs <- customer_dates %>%
group_by(CustomerID) %>%
mutate(DaysBetween = as.numeric(New_Invoice_Date - lag(New_Invoice_Date))) %>%
ungroup()
avg_days <- mean(customer_diffs$DaysBetween, na.rm = TRUE)
cat("Avg num days:", round(avg_days, 2))
#Question 10
france_data <- subset(data, Country == "France")
total_rows <- nrow(france_data)
negative_rows <- sum(france_data$Quantity < 0, na.rm = TRUE)
neg_ratio <- negative_rows / total_rows
cat("Ratio:", round(neg_ratio, 4), "\n")
# Question 11
stockcode_tot <- aggregate(TransactionValue ~ StockCode, data = data, sum)
top_stock <- stockcode_tot[which.max(stockcode_tot$TransactionValue), ]
cat("StockCode:", top_stock$StockCode, "\nTransactionValue:", round(top_stock$TransactionValue, 2), "\n")
# Question 12
unique_customers <- length(unique(data$CustomerID[!is.na(data$CustomerID)]))
cat("Unique CustomerIDs:", unique_customers, "\n")
library(dplyr)
data <- read.csv("Online_Retail.csv")
# Question 1
country_counts <- table(data$Country)
country_df <- as.data.frame(country_counts)
# print(country_df)
colnames(country_df) <- c("Country", "TransactionCount")
total_transactions <- sum(country_df$TransactionCount)
# print(total_transactions)
country_df$Percentage <- (country_df$TransactionCount / total_transactions) * 100
country_df_filtered <- subset(country_df, Percentage > 1)
country_df_filtered <- country_df_filtered[order(-country_df_filtered$TransactionCount), ]
print(country_df_filtered)
# Question 2
data$TransactionValue <- data$Quantity * data$UnitPrice
head(data$TransactionValue)
# Question 3
country_transaction_values <- aggregate(TransactionValue ~ Country, data = data, sum)
target_countries <- subset(country_transaction_values, TransactionValue > 130000)
target_countries <- target_countries[order(-target_countries$TransactionValue), ]
print(target_countries)
# Question 4
Temp=strptime(data$InvoiceDate,format='%m/%d/%Y %H:%M',tz='GMT')
# head(Temp)
data$New_Invoice_Date <- as.Date(Temp)
data$New_Invoice_Date[20000]- data$New_Invoice_Date[10]
data$Invoice_Day_Week= weekdays(data$New_Invoice_Date)
data$New_Invoice_Hour = as.numeric(format(Temp, "%H"))
data$New_Invoice_Month = as.numeric(format(Temp, "%m"))
# Question 4a
day_counts <- table(data$Invoice_Day_Week)
day_df <- as.data.frame(day_counts)
colnames(day_df) <- c("Day", "TransactionCount")
total_transactions <- sum(day_df$TransactionCount)
day_df$Percentage <- (day_df$TransactionCount / total_transactions) * 100
print(day_df)
# Question 4b
day_value_df <- aggregate(TransactionValue ~ Invoice_Day_Week, data = data, sum)
total_volume <- sum(day_value_df$TransactionValue)
day_value_df$Percentage <- (day_value_df$TransactionValue / total_volume) * 100
print(day_value_df)
# Question 4c
month_value_df <- aggregate(TransactionValue ~ New_Invoice_Month, data = data, sum)
total_volume <- sum(month_value_df$TransactionValue)
month_value_df$Percentage <- (month_value_df$TransactionValue / total_volume) * 100
print(month_value_df)
# Question 4d
au_data <- subset(data, Country == "Australia")
date_counts <- table(au_data$New_Invoice_Date)
max_date <- names(date_counts[which.max(date_counts)])
max_count <- max(date_counts)
cat("Highest AU date:", max_date, "\nTransactions:", max_count, "\n")
#Question 4e
work_hrs <- subset(data, New_Invoice_Hour >= 7 & New_Invoice_Hour <= 20)
hr_cnts <- table(work_hrs$New_Invoice_Hour)
min_transactions <- Inf
best_start <- NA
for (i in 7:19) {
count1 <- hr_cnts[as.character(i)]
count2 <- hr_cnts[as.character(i + 1)]
total <- sum(count1, count2, na.rm = TRUE)
if (total < min_transactions) {
min_transactions <- total
best_start <- i
}
}
cat("Start:", best_start, ":00 to", best_start + 2, ":00\nTransactions:", min_transactions, "\n")
# Question 5
germany_data <- subset(data, Country == "Germany")
hist(
germany_data$TransactionValue,
main = "Transaction Histogram - Germany",
xlab = "Transaction Value",
col = "red"
)
# Question 6
transaction_counts <- table(data$CustomerID)
max_count_id <- names(which.max(transaction_counts))
max_count <- max(transaction_counts)
#cat("CustomerID:", max_count_id, "\n")
#cat("Transactions:", max_count, "\n\n")
cust_val <- aggregate(TransactionValue ~ CustomerID, data = data, sum)
best_cust <- cust_val[which.max(cust_val$TransactionValue), ]
cat("Frequent Customer:", max_count_id, "\n", "Transactions:", max_count, "\n", "Best Customer:", best_cust$CustomerID, "\n", "Value:", round(best_cust$TransactionValue, 2), "\n")
# Question 7
missing_percent <- colMeans(is.na(data)) * 100
print(round(missing_percent, 2))
# Question 8
missing_id <- subset(data, is.na(CustomerID))
missing_by_country <- table(missing_id$Country)
missing_by_country_df <- as.data.frame(missing_by_country)
colnames(missing_by_country_df) <- c("Country", "MissingID_Count")
print(missing_by_country_df[order(-missing_by_country_df$MissingID_Count), ])
# Question 9
data_filter <- subset(data, !is.na(CustomerID))
customer_dates <- data_filter %>%
distinct(CustomerID, New_Invoice_Date) %>%
arrange(CustomerID, New_Invoice_Date)
customer_diffs <- customer_dates %>%
group_by(CustomerID) %>%
mutate(DaysBetween = as.numeric(New_Invoice_Date - lag(New_Invoice_Date))) %>%
ungroup()
avg_days <- mean(customer_diffs$DaysBetween, na.rm = TRUE)
cat("Avg num days:", round(avg_days, 2))
#Question 10
france_data <- subset(data, Country == "France")
total_rows <- nrow(france_data)
negative_rows <- sum(france_data$Quantity < 0, na.rm = TRUE)
neg_ratio <- negative_rows / total_rows
cat("Ratio:", round(neg_ratio, 4), "\n")
# Question 11
stockcode_tot <- aggregate(TransactionValue ~ StockCode, data = data, sum)
top_stock <- stockcode_tot[which.max(stockcode_tot$TransactionValue), ]
cat("StockCode:", top_stock$StockCode, "\nTransactionValue:", round(top_stock$TransactionValue, 2), "\n")
# Question 12
unique_customers <- length(unique(data$CustomerID[!is.na(data$CustomerID)]))
cat("Unique CustomerIDs:", unique_customers, "\n")
setwd("~/GitHub/64018-001_QMM_cwood19/Module 6")
# Initiate library to use
library(lpSolveAPI)
# Creating the model with an lp file
x <- read.lp("QMM_cwood19_6.lp")
print(x)
# Initiate library to use
library(lpSolveAPI)
# Creating the model with an lp file
x <- read.lp("QMM_cwood19_6.lp")
# Initiate library to use
library(lpSolveAPI)
# Creating the model with an lp file
x <- read.lp("QMM_cwood19_6.lp")
# Initiate library to use
library(lpSolveAPI)
# Creating the model with an lp file
x <- read.lp("QMM_cwood19_6.lp")
print(x)
# Initiate library to use
library(lpSolveAPI)
# Creating the model with an lp file
x <- read.lp("QMM_cwood19_6.lp")
print(x)
# Initiate library to use
library(lpSolveAPI)
# Creating the model with an lp file
x <- read.lp("QMM_cwood19_6.lp")
print(x)
solve(x)
o_val <- get.objective(x)
cat(sprintf("Minimum Cost: $%.2f\n", o_val))
get.variables(x)
get.constraints(x)
lp_results <- data.frame(LP_Variable = colnames(x), LP_Value = get.variables(x))
print(lp_results)
# Initiate library to use
library(lpSolveAPI)
# Creating the model with an lp file
x <- read.lp("QMM_cwood19_6.lp")
#print(x)
solve(x)
o_val <- get.objective(x)
cat(sprintf("Minimum Cost: $%.2f\n", o_val))
get.variables(x)
get.constraints(x)
lp_results <- data.frame(LP_Variable = colnames(x), LP_Value = get.variables(x))
print(lp_results)
# Initiate library to use
library(lpSolveAPI)
# Creating the model with an lp file
x <- read.lp("QMM_cwood19_6.lp")
#print(x)
solve(x)
o_val <- get.objective(x)
cat(sprintf("Minimum Cost: $%.2f\n", o_val))
get.variables(x)
get.constraints(x)
lp_results <- data.frame(LP_Variable = colnames(x), LP_Value = get.variables(x))
print(lp_results)
# Initiate library to use
library(lpSolveAPI)
# Creating the model with an lp file
x <- read.lp("QMM_cwood19_6.lp")
#print(x)
solve(x)
o_val <- get.objective(x)
cat(sprintf("Minimum Cost: $%.2f\n", o_val))
get.variables(x)
get.constraints(x)
lp_results <- data.frame(LP_Variable = colnames(x), LP_Value = get.variables(x))
print(lp_results)
